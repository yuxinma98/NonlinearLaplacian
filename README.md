# Nonlinear Laplacian Analysis

This repository contains the Python code accompanying the paper: **Nonlinear Laplacians: Simple and tunable principal component analysis under directional prior information**.

<!-- The codebase includes implementations for:

* Numerical computation of the critical signal strength $\beta^*(\sigma)$ for the Planted Submatrix and Gaussian Sparse Non-negative PCA models (see `theoretical_analysis/`).
* Identifying optimal $\sigma$ functions using various numerical approaches. For the approach using Neural Network training, see `learning_from_data/`.
* Scripts to reproduce the plots presented in the paper. -->

## Requirements

* **Python:** Python 3.9
* **Dependencies:** See `environment.yml` for the full list of required packages.
If you have Anaconda or Miniconda installed, you can run the following command to  create a new Conda environment named `nonlinear_laplacian`  and install all required packages. You may need to adjust the `environment.yml` file if you do not have a GPU with CUDA support.
    ```bash
    conda env create -f environment.yml -n nonlinear_laplacian
    ```

## Usage: Reproducing Paper Results
* **Generate plots:** Figures 1, 2, 3, and 4 of the paper is generated by the Jupyter notebook `generate_plots.ipynb`. They use the result files in `logs/` generated by the scripts `blackbox_optimization.py`, `eigenvalue_histograms.py`, `phase_transition.py`, `zshape_grid_search.py`. 
* **Rerun Blackbox Optimization:** To rerun blackbox optimization for a specific `[model_name]` (`planted_submatrix` or `gaussian_sparse_nnpca`) using sigma parametrization `[sigma]` (`tanh`, `zshape` or `step`):
    1.  Remove the corresponding result file: `logs/{model_name}/optimization_{sigma}.pkl`
    2.  Execute the command:
        ```bash
        python -m blackbox_optimization --model [model_name] --sigma [sigma]
        ```
    This command will run the optimization and regenerate the specified result file.
<!-- * **Rerun grid search for the Z-shaped $\sigma$:** To rerun the script that explore how $\beta^*$ varies with parameters $a,b,c$ for the Z-shaped $\sigma$, for a specific `[model_name]` (`planted_submatrix` or `gaussian_sparse_nnpca`):
    1. Remove the corresponding result files: `logs/{model_name}/c_critical*`.
    2. Ensure the blackbox optimization result file `logs/{model_name}/optimization_zshape.pkl` is available.
    3. Execute the command:
        ```bash
        python -m zshape_grid_search --model [model_name]
        ```
* **Rerun phase transition experiment:** To rerun the script that take the optimized $\sigma$, check how $\lambda_1(\bm{L}), \langle \bm{v}_1(\bm{L}), \bm{x}\rangle$ varies with $\beta$, for a specific `[model_name]` (`planted_submatrix` or `gaussian_sparse_nnpca`) using sigma parametrization `[sigma]` (`tanh`, `zshape` or `step`):
    1. Remove the corresponding result files: `logs/{model_name}/{sigma}_top_eigen_n=2000_N=100.pkl`
    2. Ensure the blackbox optimization result file `logs/{model_name}/optimization_{sigma}.pkl` is available.
    3. Execute the command:
        ```bash
        python -m phase_transition --model [model_name] --sigma [sigma]
        ``` -->
**Warning:** Expect long running time for the `gaussian_sparse_nnpca` model.